

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>proximal_convex_conj_kl_cross_entropy &mdash; odl 1.0.0.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="proximal_convex_conj_l1" href="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_l1.html" />
    <link rel="prev" title="proximal_convex_conj_kl" href="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> odl
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with ODL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/guide.html">User’s guide – selected topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/math.html">Mathematical Background</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer zone</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/dev.html">Contributing to ODL</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful facts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../odl.html">odl</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../odl.contrib.html">contrib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.deform.html">deform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.diagnostics.html">diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.discr.html">discr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.operator.html">operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.phantom.html">phantom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.set.html">set</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../odl.solvers.html">solvers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../odl.solvers.functional.html">functional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../odl.solvers.iterative.html">iterative</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../odl.solvers.nonsmooth.html">nonsmooth</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.admm.html">admm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.alternating_dual_updates.html">alternating_dual_updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.difference_convex.html">difference_convex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.douglas_rachford.html">douglas_rachford</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.forward_backward.html">forward_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.primal_dual_hybrid_gradient.html">primal_dual_hybrid_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../odl.solvers.nonsmooth.proximal_gradient_solvers.html">proximal_gradient_solvers</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../odl.solvers.nonsmooth.proximal_operators.html">proximal_operators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../odl.solvers.smooth.html">smooth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../odl.solvers.util.html">util</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../odl.space.html">space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.tomo.html">tomo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.trafos.html">trafos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.ufunc_ops.html">ufunc_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../odl.util.html">util</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">odl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../odl.html">odl</a> &raquo;</li>
        
          <li><a href="../odl.solvers.html">solvers</a> &raquo;</li>
        
          <li><a href="../odl.solvers.nonsmooth.html">nonsmooth</a> &raquo;</li>
        
          <li><a href="../odl.solvers.nonsmooth.proximal_operators.html">proximal_operators</a> &raquo;</li>
        
      <li>proximal_convex_conj_kl_cross_entropy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/generated/odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl_cross_entropy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="proximal-convex-conj-kl-cross-entropy">
<h1>proximal_convex_conj_kl_cross_entropy<a class="headerlink" href="#proximal-convex-conj-kl-cross-entropy" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl_cross_entropy">
<code class="sig-prename descclassname"><span class="pre">odl.solvers.nonsmooth.proximal_operators.</span></code><code class="sig-name descname"><span class="pre">proximal_convex_conj_kl_cross_entropy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/odl/solvers/nonsmooth/proximal_operators.html#proximal_convex_conj_kl_cross_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl_cross_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Proximal factory of the convex conj of cross entropy KL divergence.</p>
<p>Function returning the proximal factory of the convex conjugate of the
functional F, where F is the cross entropy Kullback-Leibler (KL)
divergence given by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">sum_i</span> <span class="p">(</span><span class="n">x_i</span> <span class="n">ln</span><span class="p">(</span><span class="n">pos</span><span class="p">(</span><span class="n">x_i</span><span class="p">))</span> <span class="o">-</span> <span class="n">x_i</span> <span class="n">ln</span><span class="p">(</span><span class="n">g_i</span><span class="p">)</span> <span class="o">+</span> <span class="n">g_i</span> <span class="o">-</span> <span class="n">x_i</span><span class="p">)</span> <span class="o">+</span> <span class="n">ind_P</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>with <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">g</span></code> in the linear space <code class="docutils literal notranslate"><span class="pre">X</span></code>, and <code class="docutils literal notranslate"><span class="pre">g</span></code> non-negative.
Here, <code class="docutils literal notranslate"><span class="pre">pos</span></code> denotes the nonnegative part, and <code class="docutils literal notranslate"><span class="pre">ind_P</span></code> is the indicator
function for nonnegativity.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>space</strong><span class="classifier"><a class="reference internal" href="odl.space.base_tensors.TensorSpace.html#odl.space.base_tensors.TensorSpace" title="odl.space.base_tensors.TensorSpace"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TensorSpace</span></code></a></span></dt><dd><p>Space X which is the domain of the functional F</p>
</dd>
<dt><strong>lam</strong><span class="classifier">positive float, optional</span></dt><dd><p>Scaling factor.</p>
</dd>
<dt><strong>g</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">space</span></code> element, optional</span></dt><dd><p>Data term, positive. If None it is take as the one-element.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>prox_factory</strong><span class="classifier">function</span></dt><dd><p>Factory for the proximal operator to be initialized.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl.html#odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl" title="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proximal_convex_conj_kl</span></code></a></dt><dd><p>proximal for related functional</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The functional is given by the expression</p>
<div class="math">
<p><img src="../_images/math/a4cb43f4fba002b45940050e67d3dba72166e908.png" alt="F(x) = \sum_i (x_i \ln(pos(x_i)) - x_i \ln(g_i) + g_i - x_i) +
I_{x \geq 0}(x)"/></p>
</div><p>The indicator function <img class="math" src="../_images/math/59c54e81d176b66539bf516cd9f7ea3b3955c0bd.png" alt="I_{x \geq 0}(x)"/> is used to restrict the
domain of <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/> such that <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/> is defined over whole space
<img class="math" src="../_images/math/ed38fa24f1c94891bd312012aab3f6673be3eb83.png" alt="X"/>. The non-negativity thresholding <img class="math" src="../_images/math/40afbc58cd638b7d86e662fc1d8554912598a3db.png" alt="pos"/> is used to define
<img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/> in the real numbers.</p>
<p>Note that the functional is not well-defined without a prior g. Hence, if g
is omitted this will be interpreted as if g is equal to the one-element.</p>
<p>The convex conjugate <img class="math" src="../_images/math/0a2e5586533053bea0a268a3c5a9fe2571725817.png" alt="F^*"/> of <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/> is</p>
<div class="math">
<p><img src="../_images/math/74274a3114a1dc82050a40add5f5549716967fb2.png" alt="F^*(p) = \sum_i g_i (exp(p_i) - 1)"/></p>
</div><p>where <img class="math" src="../_images/math/141bbefb74014fc5e43499901bf78607ae335583.png" alt="p"/> is the variable dual to <img class="math" src="../_images/math/888f7c323ac0341871e867220ae2d76467d74d6e.png" alt="x"/>.</p>
<p>The proximal operator of the convex conjugate of <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/> is</p>
<div class="math">
<p><img src="../_images/math/d7d8e8441a57d30dcac80e181c26ea2e72d6312f.png" alt="\mathrm{prox}_{\sigma (\lambda F)^*}(x) = x - \lambda
W(\frac{\sigma}{\lambda} g e^{x/\lambda})"/></p>
</div><p>where <img class="math" src="../_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> is the step size-like parameter, <img class="math" src="../_images/math/cefc603e5658facb747581f9567192993f21c7ab.png" alt="\lambda"/> is
the weighting in front of the function <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/>, and <img class="math" src="../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/> is the
Lambert W function (see, for example, the
<a class="reference external" href="https://en.wikipedia.org/wiki/Lambert_W_function">Wikipedia article</a>).</p>
<p>For real-valued input x, the Lambert <img class="math" src="../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/> function is defined only for
<img class="math" src="../_images/math/1023e895a785291e4b41b62f0d25b165b31dc6f6.png" alt="x \geq -1/e"/>, and it has two branches for values
<img class="math" src="../_images/math/b67641d8aa69f3fc04dac3bc8fc21fc3a39f1d03.png" alt="-1/e \leq x &lt; 0"/>. However, for inteneded use-cases, where
<img class="math" src="../_images/math/cefc603e5658facb747581f9567192993f21c7ab.png" alt="\lambda"/> and <img class="math" src="../_images/math/157ba5711de84b4c715a0478fd8ae440e596d96e.png" alt="g"/> are positive, the argument of <img class="math" src="../_images/math/1fbee781f84569077719a167b64e12064360fac1.png" alt="W"/>
will always be positive.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Wikipedia article on Kullback Leibler divergence</a>.
For further information about the functional, see for example <a class="reference external" href="http://ieeexplore.ieee.org/document/1056144/?arnumber=1056144">this article</a>.</p>
<p>The KL cross entropy functional <img class="math" src="../_images/math/df00656702b70b4b6f7ffbf6a9aa9a334bab1914.png" alt="F"/>, described above, is related to
another functional functional also know as KL divergence. This functional
is often used as data discrepancy term in inverse problems, when data is
corrupted with Poisson noise. This functional is obtained by changing place
of the prior and the variable. See the See Also section.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_l1.html" class="btn btn-neutral float-right" title="proximal_convex_conj_l1" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="odl.solvers.nonsmooth.proximal_operators.proximal_convex_conj_kl.html" class="btn btn-neutral float-left" title="proximal_convex_conj_kl" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2014-2020 The ODL Contributors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>